!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.fibrelite=n()}(this,function(){return function(e,n){var t=this,o=[];this.maxThreads=n||1,this.id=0;var r=function(e){t.cachedFn||(t.cachedFn="onmessage=("+function(e){return function(n){Promise.resolve(n.data[1]).then(e.apply.bind(e,e)).then(function(e){postMessage([n.data[0],0,e])},function(e){postMessage([e.data[0],1,""+e])})}}+")("+e+")");var n=new Worker(URL.createObjectURL(new Blob([t.cachedFn]))),o=0,r={};return n.resolved=!1,n.onmessage=function(e){r[e.data[0]][e.data[1]](e.data[2]),r[e.data[0]]=null,n.resolved=!0},{id:t.id++,worker:n,fn:function(e){return e=[].slice.call(arguments),new Promise(function(){r[++o]=arguments,n.resolved=!1,n.postMessage([o,e])})}}};this.roundRobin=0,this.prioritiseExecute=function(i){return new Promise(function(t,s){for(this.roundRobin++,this.roundRobin>=n-1&&(this.roundRobin=0);o.length<n;)o.unshift(r(e));var u=o.pop();return new Promise(function(e){e(u.worker.terminate())}),t(o[this.roundRobin].fn(i))}.bind(t))},this.getCurrentWorker=function(){return currentThread.worker}}});
//# sourceMappingURL=fibrelite.umd.js.map
